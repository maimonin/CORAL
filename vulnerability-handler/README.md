# Vulnerability Handler

## Purpose

The Vulnerability Handler module is designed to manage and analyze vulnerabilities within containerized environments. It leverages tools like Trivy for scanning and parsing vulnerability data to provide actionable insights.

This module collects data about vulnerabilities in cluster in two steps:
1. Scan cluster for vulnerabilities using Trivy and save report as JSON.
2. Parse JSON report file and create appropriate CSV vulnerabilities data file.


## Directory Structure

```
.
|-- cve_count_creator.py
|-- README.md
|-- trivy_parser.py
|-- Trivy
    |-- README.md
    |-- trivy_vuln_scan.json
```


## Files and Directories

### `cve_count_creator.py`
A Python script to count and categorize Common Vulnerabilities and Exposures (CVEs) based on their severity and occurrence.

### `trivy_parser.py`
A Python script to parse JSON output from Trivy scans into a more readable and actionable format.

The script reads Trivy's scan report JSON file as a Python dictionary and parse it to create relevant data in CSV output.

#### Output 
Trivy Parser output contains the following fields:
* Name
* PkgName
* InstalledVersion
* VulernabilityID
* Severity
* Title
* CVSS


### Trivy

This directory contains resources related to Trivy, including its scan outputs and a dedicated README file.
- `Trivy/trivy_vuln_scan.json`: Sample JSON output from a Trivy vulnerability scan. This file serves as a reference or template for Trivy scan data.

#### Overview

- Trivy is a comprehensive and versatile security scanner.
- Trivy has *scanners* that look for security issues, and *targets* where it can find those issues.
- _Trivyâ€™s CVEs DB is updated from time to time._

##### Targets (what Trivy can scan):
- Container Image
- Filesystem
- Git Repository (remote)
- Virtual Machine Image
- Kubernetes
- AWS

##### Scanners (what Trivy can find there):
- OS packages and software dependencies in use (SBOM)
- Known vulnerabilities (CVEs)
- IaC issues and misconfigurations
- Sensitive information and secrets
- Software licenses

More information about Trivy: [Trivy README](Trivy/README.md)


#### Usage 

In this project, Trivy is used to:

* Scan Kubernetes cluster for security issues and generate security reports.
* Scan a full cluster and generate a simple summary report.
* Get all the detail the output contains.
* Filter by security check (Vulnerabilities).
* Output: JSON of a full cluster scan.
* Trivy CLI command: ``` trivy k8s -n attack-graphs --report summary all --security-checks vuln --format json >> trivy_vuln_scan.json ```

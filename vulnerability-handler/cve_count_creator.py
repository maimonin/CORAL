import pandas as pd

def create_cve_count(input_csv_path, output_txt_path):
    """
    Read a CSV file containing CVE data, calculate the total score for each 'Pod-ID', and save the results to a text file.

    Args:
    - input_csv_path (str): Path to the input CSV file containing CVE data.
    - output_txt_path (str): Path to the output text file where results will be saved.
    """
    # Read the CSV file into a pandas DataFrame
    df = pd.read_csv(input_csv_path)

    # Group the data by 'Pod-ID' and aggregate the count of occurrences
    grouped_data = df.groupby('Pod-ID').agg({
        'Pod-ID': 'count'
    })
    grouped_data.columns = ['Total Score']

    # Prepare result lines for each 'Pod-ID' and its total score
    result_lines = []
    for pod_id, total_score in grouped_data.itertuples():
        output_line = f"# CVEs of {pod_id}: Total Score: {total_score}"
        result_lines.append(output_line)

    # Save the result lines to a text file
    with open(output_txt_path, 'w') as txt_file:
        txt_file.write('\n'.join(result_lines))


if __name__ == '__main__':
    create_cve_count('/home/ubuntu/attack-graphs-/vulnerabilities_scanner/cve_static_data_2023-12-07.csv', '/home/ubuntu/attack-graphs-/vulnerabilities_scanner/cve_count.txt')
